I"ƒ<p>Quanto mais mexemos com <em>git</em> mais descobrimos coisas mirabolantes que ele pode fazer. Descobri h√° um tempo atr√°s uma maneira de organizar/alterar seus <em>commits</em> e que me ajudou bastante.</p>

<p>Editar <em>commits</em>? Pra que? Pois √©. Alguns casos:</p>

<ul>
  <li>a mensagem do <em>commit</em> est√° errada ou n√£o faz sentido;</li>
  <li>a ordem dos commits n√£o est√° legal em rela√ß√£o √† hist√≥ria;</li>
  <li>existe mais de um <em>commit</em> que fazem coisas similares (sen√£o a mesma coisa).</li>
  <li>um <em>commit</em> agrupou muito c√≥digo diferente e faz sentido dividi-lo em <em>commits</em> menores.</li>
</ul>

<h2 id="um-exemplo-r√°pido">Um exemplo r√°pido</h2>

<p>Um exemplo simples e r√°pido. Imagine que no seu projeto voc√™ fez uma altera√ß√£o e fez um <em>commit</em>:</p>

<script src="https://gist.github.com/90a6a97130985c4b7c22c92521efa0cd.js"> </script>

<p>A√≠ voc√™ lembrou que tinha que atualizar o <code class="highlighter-rouge">README</code> (ou preferiu deixar em <em>commits</em> separados) do projeto:</p>

<script src="https://gist.github.com/a1ae888b8bec5945c71bfd320dcd30ba.js"> </script>

<p>Ent√£o voc√™ sai pra pegar um ch√° (n√£o bebo caf√© ¬Ø\_(„ÉÑ)_/¬Ø) e no meio do caminho lembra que faltou uma altera√ß√£o de CSS. A√≠ voc√™ volta, faz a altera√ß√£o e comita novamente:</p>

<script src="https://gist.github.com/69fab53ddba3552abf7a5bca490e1480.js"> </script>

<p>Se rod√°ssemos um simples <em>log</em> para ver os <em>commits</em> ter√≠amos algo assim (limitei apenas aos 3 √∫ltimos, para o exemplo):</p>

<script src="https://gist.github.com/658e70c8020eb959214b6176f47c8cca.js"> </script>

<p>Se o projeto √© pequeno/pessoal, at√© daria pra deixar assim, no entanto, quando estamos trabalhando com outras pessoas em um projeto grande, pode ficar meio estranho no conjunto da hist√≥ria. √â a√≠ que entra o <em>interactive rebase</em>. Com ele conseguimos alterar <em>commits</em> em um mesmo <em>branch</em>. Paremos de falar e vamos ao que interessa.</p>

<h2 id="como-fa√ßo">Como fa√ßo?</h2>

<script src="https://gist.github.com/3c311e78b1ea83e571956ea06d3f642c.js"> </script>

<p>Rodamos o comando acima onde o:</p>

<ul>
  <li><code class="highlighter-rouge">-i</code> =&gt; modo interativo.</li>
  <li><code class="highlighter-rouge">~3</code> =&gt; n√∫meros de <em>commits</em> para abranger.</li>
</ul>

<p>Feito isso aparecer√° uma tela similar a essa abaixo (todas <em>telas</em> citadas abaixo ir√£o abrir no seu editor que estiver setado como <em>default</em>):</p>

<script src="https://gist.github.com/83068ff07ed98e3c5d72a6a9155a2e3e.js"> </script>

<h2 id="reordenando-commits">Reordenando <em>commits</em></h2>

<p>No exemplo acima poder√≠amos alterar a ordem dos <em>commits</em> deixando juntos os que s√£o relacionados ao mesmo tema por exemplo. Pra isso, na tela anterior, edite a ordem copiando e colando as linhas na ordem que preferir. Para o exemplo, poder√≠amos algo mais ou menos assim:</p>

<script src="https://gist.github.com/fb24d09ac3495ec6af419368ebc99a48.js"> </script>

<p>E ‚Ä¶ pronto! Se Se ocorreu tudo certo aparecer√° uma mensagem mais ou menos assim:</p>

<script src="https://gist.github.com/d873a435ff7954d18a9f171ca4a7df80.js"> </script>

<p>Pode ser que conflitos ocorram, nesse caso o <code class="highlighter-rouge">rebase</code> para at√© que voc√™ o corrija. Depois √© s√≥ rodar um <code class="highlighter-rouge">git rebase --continue</code> para seguir ou um <code class="highlighter-rouge">git rebase --abort</code> se quiser desistir de tudo.</p>

<h2 id="alterando-mensagens">Alterando mensagens</h2>

<p>Outra coisa beeeem bacana √© a possibilidade de alterar a mensagem de um <em>commit</em>. Voltando ao nosso exemplo, agora queremos trocar a mensagem do <em>commit do README</em>.</p>

<p>Rodamos novamente o <em>rebase</em>:</p>

<script src="https://gist.github.com/82690be5a679bbaba53f8e6f955fbef3.js"> </script>

<p>Ca√≠mos novamente naquela tela com a listagem dos <em>commits</em>. A√≠ digitamos <code class="highlighter-rouge">reword</code> no <em>commit</em> que quisermos editar a mensagem.</p>

<script src="https://gist.github.com/38ba4f56846faa26f6017caf26d5861a.js"> </script>

<p>Feito isso, ca√≠remos em outra tela, similar a essa:</p>

<script src="https://gist.github.com/8ed05e1d9253aacbe6aa1cbbe7a5e844.js"> </script>

<p>A√≠ √© s√≥ <em>taca-le pau</em> na nova mensagem.</p>

<script src="https://gist.github.com/6944b66ccca4980a7f9c5e0c19bb7020.js"> </script>

<p>E‚Ä¶ pronto! \o/ Se rodarmos um <em>log</em> simples, veremos a lista dos <em>commits</em> com a mensagem atualizada:</p>

<script src="https://gist.github.com/ccc86e3c2db01bd2df15769f3d80100d.js"> </script>

<h2 id="for√ßando-o-push">For√ßando o push</h2>

<p><a href="https://github.com/raphaelfabeni/raphaelfabeni.github.io/issues/9">Como bem lembrado</a> pelo <a href="https://github.com/ciceropablo">C√≠cero Pablo</a>, quando utilizamos o <em>rebase interativo</em>, caso voc√™ j√° tenha um reposit√≥rio com uma <em>hist√≥ria de commits</em>, ser√° preciso fazer <code class="highlighter-rouge">push</code>com a flag <code class="highlighter-rouge">--force</code>.</p>

<h2 id="tem-mais">Tem mais..</h2>

<p>Pra n√£o ficar muito extenso, dividi o assunto em 2 posts. No pr√≥ximo vamos falar de mesclar <em>commits</em> e dividir um <em>commit</em> em dois. <a href="/git-alterando-commits-parte-2/">Aqui voc√™ consegue ler a segunda parte do artigo</a>.</p>

<p><strong>Obs</strong>.</p>

<ul>
  <li>Os nomes/estrutura dos arquivos e mensagens de <em>commit</em> s√£o a t√≠tulos de exemplo.</li>
  <li>Usei a palavra tela para referenciar cada retorno do terminal.</li>
  <li>Uso por padr√£o como editor o <em>vim</em>, o que facilita a edi√ß√£o das ‚Ä¢telas‚Ä¢ que comentei no t√≥pico anterior.</li>
</ul>
:ET